select ro.id as ID, lf.name as locationFrom, pf.name as ParentFrom, lt.name as locationTo, pt.name as ParentTo INTO OUTFILE '/tmp/jonathan_routes01.csv' from udo_route as ro left join udo_location as lf on (lf.id=ro.locationFrom_id) left join udo_location as lt on (lt.id=ro.locationTo_id) left join udo_location as pf on (pf.id=lf.parent_id) left join udo_location as pt on (pt.id=lt.parent_id) where (ro.expectedKms = 0 OR ISNULL(ro.expectedKms)) AND lf.name IN ("Port Elizabeth","De Hoek","Slurry","Montague Gardens","George","Saldanha","Polokwane","Pretoria","Warehouse (Slurry)","Germiston (JHB)","Bloemhof (NW)","Gaborone","Queenstown","Pietermaritzburg","Paarl","Ladismith","Durbanville","Delmas","Randfontein","Boksburg (JHB)","Cape Town","Malelane","Isando (JHB)","Umzimkhulu","Eston","Sezela","Stanger","Marlboro","Maitland","East London") AND NOT lt.name like "%multi%drop%" AND NOT lt.name like "%pickup%%";
