select t.fleetnum as truck, IF(tl.kmsEnd, tl.kmsEnd, tl.kmsBegin) as LastOdo, ca.tripNumber, IF(tl.loadingArrivalETA, tl.loadingArrivalETA, NULL) as loadingArrivalETA, IF(tl.loadingStarted, tl.loadingStarted, NULL) as loadingStarted, IF(tl.offloadingCompleted, tl.offloadingCompleted, NULL) from udo_tripleg as tl left join udo_truck as t on (t.id=tl.truck_id) left join udo_triplegcargo as tlc on (tlc.tripLeg_id=tl.id) left join udo_cargo as ca on (ca.id=tlc.cargo_id)
where tl.truck_id IN (1629,1630,1631,1632,1633,1634,1635,1636,1637,1638,1639,1640,1641,1642,1643,1644,1645,1659,1660,1664,1665,1666,1668,1669,1670,1682,1685,1688,1689,1690,1691,1692,1693,1694,1695,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1713,1721,1757,1799,1800,1801,1802,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1854,1855,1940,2016,2017,2018,2019,2099,2100,2101,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2177,2181,2182,2183,2184,2200,2201,2202,2203,2204,2205,2206,2211,2212,2213,2216,2217,2218,2219,2220,2221,2238,2239,2240,2241,2242,2243,2244,2245,2246,2248,2249,2250,2251,2252,2253,2261,2262,2265,2266,2267,2268,2269,2270,2271,2272,2273,2274,2275,2276,2277,2278,2279,2280,2281,2290,2291,2300,2301,2302,2312,2313,2314,2315,2316,2317,2318,2321,2322,2323,2324,2325,2326,2327,2328,2329,2330,2331,2332,2333,2334,2335,2336,2337,2341,2342,2343,2370,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2384,2385,2386,2387,2401,2403,2404,2662,2663,2664,2665,2666,2789,2790,2870,2871,2872,2873,2896,2902,2903,2905,2906,2907,2908,2909,2910,2911,2912,2914,2915,2916,2917,2918,2922,2923,2927,2929,2935,2936,2950,2951,2952,2953,2954,2955,2956,2957,2966,2967,2968,2969,3002,3011,3012,3013,3016,3017,3018,3032,3033,3042,3044,3047,3055,3056,3057,3059,3060,3061,3065,3073,3074,3076,3086,3111,3112,3113,3125,3126,3127,3128,3129,3130,3131,3132,3133,3134,3135,3136,3137,3138,3142,3143,3144,3156,3157,3158,3159,3330,3331,3332,3333,3334,3335,3336,3337,3338,3339,3340,3341,3342,3343,3344,3345,3351,3365,3366,3367,3368,3369,3370,3371,3372,3373,3374,3375,3376,3377,3378,3379,3380,3381,3382,3383,3384,3385,3386,3387,3388,3389,3390,3391,3392,3393,3394,3395,3396,3397,3398,3399,3400,3401,3402,3403,3404,3405,3406,3430,3431,3432,3439,2874,2913,2919,2920,2924,2925,2926,2928,2932,2933,2934,2937)
AND tl.kmsBegin IS NOT NULL AND tl.workshopTrip = 0 AND tl.hollowTrip = 0 AND IF(tl.loadingStarted, tl.loadingStarted, tl.loadingArrivalETA) > "2015-04-28 22:00:00" AND IF(tl.loadingStarted, tl.loadingStarted, tl.loadingArrivalETA) < "2015-05-01 22:00:00" group by tl.truck_id order by IF(tl.offloadingCompleted, tl.offloadingCompleted, IF(tl.loadingFinished, tl.loadingFinished, IF(tl.loadingStarted, tl.loadingStarted, tl.loadingArrivalETA))) DESC;